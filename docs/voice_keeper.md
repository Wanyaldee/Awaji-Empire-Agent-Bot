# VoiceKeeper (寝落ち切断機能) 仕様書

## 概要

特定ユーザー（ホスト）がボイスチャンネル（VC）から退出して一定時間経過しても、まだVCに残っているユーザーを「寝落ち」と判定し、自動的に切断（Kick）する機能。
また、切断した人数を集計し、テキストチャンネルに報告する。

## 要件

### 1. トリガー条件

* **監視対象ユーザー**（環境変数で指定）がVCから退出、または別のVCへ移動した時。
* ただし、以下の **稼働時間内** である場合のみ動作する。
  * 稼働時間: 深夜帯（例: 0:00 ～ 6:00 / 環境変数で指定可能にすること）

### 2. 動作フロー

1. 監視対象ユーザーがVCから居なくなる。
2. **5分間 (300秒)** のタイマーを開始する。
3. 5分経過後、再度チェックを行う。
    * **対象ユーザーが元のVCに戻っていた場合**: 何もしない（タイマーキャンセル）。
    * **対象ユーザーが戻っていない場合**: 「切断処理」へ移行。

### 3. 切断処理と報告

1. 対象VCに残っている **Bot以外の全メンバー** を切断させる（`move_to(None)`）。
2. 切断に成功した人数をカウントする。
3. 指定されたテキストチャンネル（例: `#配信コメント`）に以下のフォーマットで報告する。
    > 【寝落ち集計】
    > 今回の犠牲者は **N人** でした。おやすみなさい。

## 環境変数 (.env)

実装にあたり、以下の環境変数を使用すること。また、実際のファイル編集はWanyaldeeが行います。

| 変数名 | 説明 | デフォルト値 |
| :--- | :--- | :--- |
| `TARGET_USER_ID` | 監視対象のDiscordユーザーID | `0` (無効) |
| `ACTIVE_START_HOUR` | 機能が有効になる開始時間 (24h表記) | `0` |
| `ACTIVE_END_HOUR` | 機能が無効になる終了時間 (24h表記) | `6` |
| `REPORT_CHANNEL_NAME` | 集計結果を報告するチャンネル名 | `配信コメント` |

## 技術スタック / 実装方針

* 言語: Python
* ライブラリ: `discord.py` (Cogs機能を使用)
* ファイル配置: `cogs/voice_keeper.py` (新規作成)
* 非同期処理 (`asyncio`) を用いて、Botのメインスレッドをブロックせずにタイマーを動作させること。
